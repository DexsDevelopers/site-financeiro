<?php
// teste_navegacao_sistemas.php - Teste de navega√ß√£o dos novos sistemas

echo "<h1>üß™ TESTE DE NAVEGA√á√ÉO DOS SISTEMAS</h1>";
echo "<hr>";

// 1. Verificar se as p√°ginas existem
echo "<h2>1. Verifica√ß√£o de Arquivos</h2>";

$paginas = [
    'rotina_diaria.php' => 'Rotina Di√°ria',
    'pomodoro.php' => 'Pomodoro Timer',
    'automatizacao_horario.php' => 'Organiza√ß√£o por Hor√°rio',
    'equipe.php' => 'Minha Equipe'
];

foreach ($paginas as $arquivo => $nome) {
    if (file_exists($arquivo)) {
        echo "‚úÖ <strong>$nome</strong> - Arquivo existe<br>";
        
        // Verificar se o arquivo tem conte√∫do v√°lido
        $content = file_get_contents($arquivo);
        if (strpos($content, '<?php') !== false && strpos($content, 'require_once') !== false) {
            echo "‚úÖ <strong>$nome</strong> - Estrutura PHP v√°lida<br>";
        } else {
            echo "‚ùå <strong>$nome</strong> - Estrutura PHP inv√°lida<br>";
        }
    } else {
        echo "‚ùå <strong>$nome</strong> - Arquivo N√ÉO existe<br>";
    }
}

echo "<br>";

// 2. Verificar configura√ß√£o do menu
echo "<h2>2. Verifica√ß√£o do Menu</h2>";

if (file_exists('includes/load_menu_config.php')) {
    $content = file_get_contents('includes/load_menu_config.php');
    
    $menu_checks = [
        'rotina_diaria.php' => 'Rotina Di√°ria no menu',
        'pomodoro.php' => 'Pomodoro no menu',
        'automatizacao_horario.php' => 'Organiza√ß√£o por Hor√°rio no menu',
        'produtividade' => 'Se√ß√£o de Produtividade'
    ];
    
    foreach ($menu_checks as $termo => $descricao) {
        if (strpos($content, $termo) !== false) {
            echo "‚úÖ <strong>$descricao</strong> - Configurado<br>";
        } else {
            echo "‚ùå <strong>$descricao</strong> - N√ÉO configurado<br>";
        }
    }
} else {
    echo "‚ùå <strong>includes/load_menu_config.php</strong> - Arquivo n√£o encontrado<br>";
}

echo "<br>";

// 3. Verificar header
echo "<h2>3. Verifica√ß√£o do Header</h2>";

if (file_exists('templates/header.php')) {
    $content = file_get_contents('templates/header.php');
    
    if (strpos($content, 'Minha Equipe') !== false) {
        echo "‚úÖ <strong>Bot√£o Minha Equipe</strong> - Restaurado<br>";
    } else {
        echo "‚ùå <strong>Bot√£o Minha Equipe</strong> - N√ÉO encontrado<br>";
    }
    
    if (strpos($content, 'equipe.php') !== false) {
        echo "‚úÖ <strong>Link para equipe.php</strong> - Configurado<br>";
    } else {
        echo "‚ùå <strong>Link para equipe.php</strong> - N√ÉO configurado<br>";
    }
} else {
    echo "‚ùå <strong>templates/header.php</strong> - Arquivo n√£o encontrado<br>";
}

echo "<br>";

// 4. Verificar se as tabelas existem
echo "<h2>4. Verifica√ß√£o das Tabelas do Banco</h2>";

try {
    require_once 'includes/db_connect.php';
    
    $tabelas = [
        'rotina_diaria' => 'Tabela de rotina di√°ria',
        'pomodoro_sessions' => 'Tabela de sess√µes de pomodoro',
        'config_rotina_padrao' => 'Tabela de configura√ß√£o de rotina'
    ];
    
    foreach ($tabelas as $tabela => $descricao) {
        $stmt = $pdo->query("SHOW TABLES LIKE '$tabela'");
        if ($stmt->rowCount() > 0) {
            echo "‚úÖ <strong>$descricao</strong> - Tabela existe<br>";
        } else {
            echo "‚ùå <strong>$descricao</strong> - Tabela N√ÉO existe<br>";
        }
    }
    
} catch (Exception $e) {
    echo "‚ùå <strong>Erro de conex√£o com banco:</strong> " . $e->getMessage() . "<br>";
}

echo "<br>";

// 5. Instru√ß√µes de teste
echo "<h2>5. Instru√ß√µes para Teste Manual</h2>";
echo "<div style='background: #e7f3ff; padding: 1rem; border-radius: 8px; margin: 1rem 0;'>";
echo "<h4>üöÄ Como testar a navega√ß√£o:</h4>";
echo "<ol>";
echo "<li><strong>Primeiro:</strong> Execute <a href='criar_tabelas_rotina_pomodoro.php' target='_blank'>criar_tabelas_rotina_pomodoro.php</a> se as tabelas n√£o existirem</li>";
echo "<li><strong>Dashboard:</strong> Acesse <a href='dashboard.php' target='_blank'>dashboard.php</a> e verifique se os novos cards est√£o na se√ß√£o de produtividade</li>";
echo "<li><strong>Menu:</strong> Verifique se o menu lateral tem a se√ß√£o 'Produtividade' com os novos itens</li>";
echo "<li><strong>Minha Equipe:</strong> Acesse <a href='equipe.php' target='_blank'>equipe.php</a> e verifique se a p√°gina carrega</li>";
echo "<li><strong>Rotina Di√°ria:</strong> Acesse <a href='rotina_diaria.php' target='_blank'>rotina_diaria.php</a> e teste os h√°bitos</li>";
echo "<li><strong>Pomodoro:</strong> Acesse <a href='pomodoro.php' target='_blank'>pomodoro.php</a> e teste o timer</li>";
echo "<li><strong>Organiza√ß√£o:</strong> Acesse <a href='automatizacao_horario.php' target='_blank'>automatizacao_horario.php</a> e veja a organiza√ß√£o por hor√°rio</li>";
echo "</ol>";
echo "</div>";

// 6. Status dos problemas
echo "<h2>6. Status dos Problemas</h2>";
echo "<div style='background: #d4edda; padding: 1rem; border-radius: 8px; margin: 1rem 0;'>";
echo "<h4>‚úÖ Problemas Resolvidos:</h4>";
echo "<ul>";
echo "<li><strong>Novos sistemas movidos para Produtividade:</strong> Rotina Di√°ria, Pomodoro e Organiza√ß√£o por Hor√°rio agora est√£o na se√ß√£o de Produtividade</li>";
echo "<li><strong>Bot√£o Minha Equipe restaurado:</strong> P√°gina equipe.php criada e link adicionado ao menu</li>";
echo "<li><strong>Menu reorganizado:</strong> Estrutura do menu atualizada para incluir os novos sistemas</li>";
echo "</ul>";
echo "</div>";

echo "<div style='background: #fff3cd; padding: 1rem; border-radius: 8px; margin: 1rem 0;'>";
echo "<h4>‚ö†Ô∏è Verifica√ß√µes Necess√°rias:</h4>";
echo "<ul>";
echo "<li><strong>Teste de acesso:</strong> Verifique se todas as p√°ginas carregam corretamente</li>";
echo "<li><strong>Banco de dados:</strong> Execute criar_tabelas_rotina_pomodoro.php se necess√°rio</li>";
echo "<li><strong>Permiss√µes:</strong> Verifique se n√£o h√° problemas de permiss√£o nos arquivos</li>";
echo "</ul>";
echo "</div>";

echo "<hr>";
echo "<p><strong>‚úÖ Teste conclu√≠do!</strong> Os sistemas foram reorganizados e o bot√£o Minha Equipe foi restaurado.</p>";
?>
